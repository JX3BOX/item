(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-88441a64"],{"0837":function(t,e,n){"use strict";n("b9c79")},"084d":function(t,e,n){},"0b4e":function(t,e,n){"use strict";n("e7d2")},1229:function(t,e,n){},"1d10":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"m-search-bar",class:"plan_view"==t.$route.name?"can-return":""},[n("div",{staticClass:"m-return"},[n("el-button",{staticClass:"u-return-btn",on:{click:t.return_handle}},[t._v("返回")])],1),n("div",{staticClass:"m-search"},[n("el-input",{staticClass:"u-search-input",attrs:{placeholder:"输入物品清单名称「回车」进行搜索"},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search_handle(e)}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}},[n("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("关键词")])]),n("el-button",{staticClass:"u-search-btn",attrs:{type:"primary",plain:""},on:{click:t.search_handle}},[t._v("搜索")])],1),n("div",{staticClass:"m-add"},[n("el-button",{staticClass:"u-add-btn",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.add_handle}},[t._v("创建清单")])],1)])},i=[],s=n("ee8f"),o=s.JX3BOX,r={name:"PlanSearch",data:function(){return{keyword:""}},methods:{return_handle:function(){history.length<=1?this.$router.push({name:"plan_list"}):history.back()},add_handle:function(){location.href="".concat(o.__Links.dashboard.publish,"#/item/plan")},search_handle:function(){this.$router.push({name:"plan_list",params:{keyword:this.keyword}})}}},l=r,c=(n("dcac"),n("2877")),u=Object(c["a"])(l,a,i,!1,null,null,null);e["a"]=u.exports},"2d41":function(t,e,n){},"624c":function(t,e,n){},"67cd":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"m-plan-view"}},[n("PlanSearch"),n("div",{staticClass:"c-plan"},[t.plan&&"{}"!==JSON.stringify(t.plan)?n("div",{staticClass:"m-module m-plan"},[n("div",{staticClass:"m-head"},[n("h4",{staticClass:"u-title"},[1==t.plan.type?n("span",{staticClass:"u-type",staticStyle:{"background-color":"#409EFF"}},[t._v("道具清单")]):t._e(),2==t.plan.type?n("span",{staticClass:"u-type",staticStyle:{"background-color":"#3cbfda"}},[t._v("装备清单")]):t._e(),n("span",{domProps:{textContent:t._s(t.plan.title)}})])]),n("div",{staticClass:"m-body"},[t.plan.description?n("div",{staticClass:"u-plan-description",attrs:{title:t.plan.description,type:"warning",closable:!1}},[t._v(" "+t._s(t.plan.description)+" ")]):t._e(),1==t.plan.type?n("el-row",{staticClass:"m-positions",attrs:{gutter:"15"}},t._l(t.plan.relation_items,(function(e,a){return n("el-col",{key:a,attrs:{xs:24,md:6}},[n("div",{staticClass:"m-position"},[e.title?n("h5",{staticClass:"u-title",domProps:{textContent:t._s(e.title)}},[n("span",{domProps:{textContent:t._s(e.title)}})]):t._e(),n("ul",{staticClass:"m-items"},[t._l(e.data,(function(t,e){return n("li",{key:e},[n("router-link",{attrs:{to:{name:"view",params:{item_id:t.id}}}},[n("jx3-item-simple",{attrs:{item:t}})],1)],1)})),e.data&&e.data.length?t._e():n("li",{staticClass:"u-items-null"},[t._v(" 暂无物品 ")])],2)])])})),1):t._e(),2==t.plan.type?n("div",{staticClass:"m-equip-plan"},[n("Equip",{attrs:{data:t.plan}})],1):t._e(),2==t.plan.type?n("el-row",{staticClass:"m-positions",attrs:{gutter:15}},t._l(t.positions,(function(e,a){return n("el-col",{key:a,attrs:{xs:24,md:6}},t._l(e,(function(e,a){return n("div",{key:a,staticClass:"m-position"},[e.label?n("h5",{staticClass:"u-title"},[n("span",{domProps:{textContent:t._s(e.label)}})]):t._e(),n("ul",{staticClass:"m-items"},[t._l(t.plan.relation_items[a],(function(e,a){return n("li",{key:a},[n("router-link",{attrs:{to:{name:"view",params:{item_id:e.id}}}},[n("jx3-item-simple",{attrs:{item:e}}),0==a?n("span",{staticClass:"u-main"},[t._v("主")]):t._e()],1)],1)})),t.plan.relation_items[a]&&t.plan.relation_items[a].length?t._e():n("li",{staticClass:"u-items-null"},[t._v(" 暂无物品 ")])],2)])})),0)})),1):t._e(),n("div",{staticClass:"m-other"},[t.plan.user_avatar?n("div",{staticClass:"avatar"},[n("img",{attrs:{src:t._f("showAvatar")(t.plan.user_avatar)}})]):t._e(),n("div",{staticClass:"done"},[n("a",{attrs:{href:t._f("author_url")(t.plan.user_id)},domProps:{textContent:t._s(t.plan.user_nickname)}})]),n("div",{staticClass:"updated",domProps:{textContent:t._s("最后编辑于 "+t.$options.filters.date_format(t.plan.updated))}})])],1),n("div",{staticClass:"m-plan-op"},[n("Fav",{attrs:{"post-type":"item_plan","post-id":t.plan.id}}),t.user.id==t.plan.user_id||t.user.group>=64?[n("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"small"},on:{click:function(e){return t.edit_plan(t.plan.id)}}},[t._v("编辑")]),n("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"small"},on:{click:function(e){return t.delete_plan(t.plan.id)}}},[t._v("删除")])]:t._e()],2)]):n("el-alert",{staticClass:"m-plan-null",attrs:{center:"",title:"😂 暂无相关物品清单信息",type:"info",closable:!1}})],1),t.plan&&"{}"!==JSON.stringify(t.plan)?n("div",{staticClass:"m-comments"},[n("el-divider",{attrs:{"content-position":"left"}},[n("span",{staticStyle:{color:"#999999"}},[n("i",{staticClass:"el-icon-chat-line-square"}),t._v(" 讨论")])]),n("jx3-comment",{attrs:{id:t.plan.id,category:"item_plan"}})],1):t._e()],1)},i=[],s=(n("99af"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-container",{staticClass:"c-comment"},[n("el-main",[n("CommentInputForm",{on:{submit:t.userSubmitInputForm}}),t._l(t.commentList,(function(e){return n("div",{key:e.id,staticClass:"c-comment-list"},[n("Avatar",{attrs:{"user-avatar":t._f("showAvatar")(e.avatar),"user-href":t._f("profileLink")(e.userId),username:e.displayName}}),n("CommmentWithReply",{attrs:{"base-api":t.baseAPI,item:e,category:t.category,power:t.commentPower,"user-href":t._f("profileLink")(e.userId),username:e.displayName},on:{deteleComment:t.deteleComment}})],1)})),n("div",{staticClass:"c-comment-pages"},[t.commentList.length>5?n("CommentInputForm",{on:{submit:t.userSubmitInputForm}}):t._e(),n("div",{staticClass:"u-pages"},[n("el-pagination",{staticStyle:{"text-align":"right"},attrs:{background:"","hide-on-single-page":"","current-page":t.pager.index,"page-size":t.pager.pageSize,layout:"prev, pager, next, total",total:t.pager.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){return t.$set(t.pager,"index",e)},"update:current-page":function(e){return t.$set(t.pager,"index",e)}}})],1)],1)],2)],1)}),o=[],r=n("85e4"),l=n("64c7"),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"c-comment-avatar"},[n("el-link",{staticClass:"u-avatar",attrs:{href:t.userHref,target:"_blank"}},[n("el-avatar",{staticClass:"u-avatar-pic",attrs:{shape:"square",size:t.avatarSize,src:t.userAvatar}})],1),n("el-link",{staticClass:"u-name",attrs:{type:"primary",target:"_blank",href:t.userHref}},[t._v(t._s(t.username))])],1)},u=[],p={props:["avatarSize","userAvatar","userHref","username"]},m=p,d=(n("c0ba"),n("2877")),h=Object(d["a"])(m,c,u,!1,null,null,null),f=h.exports,_=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-form",{ref:"form",staticClass:"c-comment-box",attrs:{model:t.newComment}},[n("el-form-item",[n("el-input",{attrs:{rows:"3",type:"textarea",maxlength:"300","show-word-limit":"",placeholder:"参与讨论..."},model:{value:t.newComment.content,callback:function(e){t.$set(t.newComment,"content",e)},expression:"newComment.content"}}),t.showUploader?n("Uploader",{ref:"uploader",staticClass:"u-uploader",on:{onFinish:t.attachmentUploadFinish,onError:t.attachmentUplodError}}):t._e(),n("div",{staticClass:"u-toolbar"},[n("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-picture",size:"mini"},on:{click:function(e){t.showUploader=!t.showUploader}}},[t._v("图片")]),n("el-button",{staticClass:"u-publish",attrs:{type:"primary",disabled:t.disableSubmitBtn},on:{click:t.onSubmit}},[t._v("发表评论")])],1)],1)],1)},y=[],b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-upload",{ref:"upload",attrs:{action:"https://server.jx3box.com/upload","list-type":"picture-card","on-preview":t.handlePictureCardPreview,"auto-upload":!1,"file-list":t.fileList,limit:3,multiple:"","with-credentials":"","on-exceed":t.onExceed,"on-change":t.onChange,"on-success":t.onSuccess,"on-error":t.onError}},[n("i",{staticClass:"el-icon-plus"}),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(" 只能上传jpg/png/gif文件，且不超过500k的３张图片 ")])]),n("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("img",{attrs:{width:"60%",src:t.dialogImageUrl,alt:""}})])],1)},g=[],v={data:function(){return{dialogImageUrl:"",dialogVisible:!1,fileList:[],successList:[]}},methods:{handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},onExceed:function(){this.$notify({title:"",message:"文件超过数量!",type:"error",duration:3e3,position:"bottom-right"})},onChange:function(t,e){"ready"==t.status&&(t.size>512e3?(this.$notify({title:"",message:"图片大小不能超过500kb!",type:"error",duration:3e3,position:"bottom-right"}),e.pop()):this.fileList=e)},upload:function(){this.fileList.length>0?this.$refs.upload.submit():this.$emit("onFinish",[])},onSuccess:function(t){this.successList=this.successList.concat(t.data.list),this.successList.length==this.fileList.length&&(this.$emit("onFinish",this.successList||[]),this.fileList=[],this.successList=[])},onError:function(){this.$notify({title:"",message:"图片上传失败!",type:"error",duration:3e3,position:"bottom-right"}),this.$emit("onError"),this.fileList=[]}}},w=v,C=Object(d["a"])(w,b,g,!1,null,null,null),E=C.exports,A={components:{Uploader:E},data:function(){return{showUploader:!1,disableSubmitBtn:!1,newComment:{}}},methods:{onSubmit:function(){this.disableSubmitBtn=!0,this.$refs.uploader?this.$refs.uploader.upload():this.attachmentUploadFinish([])},attachmentUploadFinish:function(t){this.$emit("submit",{content:this.newComment.content,attachmentList:t}),this.newComment={},this.showUploader=!1,this.disableSubmitBtn=!1},attachmentUplodError:function(){this.disableSubmitBtn=!1}}},x=A,k=Object(d["a"])(x,_,y,!1,null,null,null),R=k.exports,L=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"c-comment-cmt"},[n("el-link",{staticClass:"u-name",attrs:{type:"primary",target:"_blank",href:t.userHref}},[t._v(t._s(t.username||"人字榜800线无名小侠"))]),n("CommentContent",{attrs:{date:t.item.commentDate,content:t.item.content,attachments:t._f("stringToArray")(t.item.attachments),"can-delete":t.power.allow||t.power.uid==t.item.userId},on:{addNewReply:t.addNewReply,deteleComment:t.deteleComment}}),n("ReplyList",{attrs:{data:t.replyList,pager:t.pager,power:t.power},on:{addNewReply:t.addNewReply,deleteReply:t.deleteReply,goto:t.gotoReplyListIndex,resetReply:t.resetReply}})],1)},S=[],N=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"u-cmt"},[""!=t.content?n("div",{staticClass:"u-text"},[t._v(t._s(t.content))]):t._e(),t.attachments.length?n("div",{staticClass:"u-attachements"},t._l(t.attachments,(function(e){return n("el-image",{key:e,attrs:{src:t._f("showAttachment")(e),"preview-src-list":t._attachments,lazy:""}})})),1):t._e(),n("div",{staticClass:"u-toolbar"},[n("el-button",{staticClass:"u-admin",attrs:{type:"text",size:"mini",icon:"el-icon-chat-round"},on:{click:function(e){t.showForm=!t.showForm}}},[t._v("回复")]),t.canDelete?n("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-delete",size:"mini"},on:{click:function(e){return t.deleteComment()}}},[t._v("删除")]):t._e(),n("time",{staticClass:"u-date"},[n("i",{staticClass:"el-icon-time"}),t._v(" "+t._s(t.dataFormat(t.date))+" ")])],1),t.showForm?n("el-form",{ref:"form",staticClass:"c-comment-subbox",attrs:{model:t.newComment}},[n("el-form-item",[n("el-input",{attrs:{type:"textarea"},model:{value:t.newComment.content,callback:function(e){t.$set(t.newComment,"content",e)},expression:"newComment.content"}}),n("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-picture",size:"mini"},on:{click:function(e){t.showUploader=!t.showUploader}}},[t._v("图片")])],1),n("el-form-item",[t.showUploader?n("Uploader",{ref:"uploader",on:{onFinish:t.attachmentUploadFinish,onError:t.attachmentUplodError}}):t._e()],1),n("el-form-item",[n("el-button",{attrs:{size:"mini",type:"primary",disabled:t.disableSubmitBtn},on:{click:function(e){return t.submit()}}},[t._v("提交")]),n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.showForm=!1}}},[t._v("收起")])],1)],1):t._e()],1)},I=[];n("d81d");function O(t){return t>9?t:"0".concat(t)}var T={props:["content","date","hasReply","canDelete","attachments"],components:{Uploader:E},data:function(){return{newComment:{},showForm:!1,disableSubmitBtn:!1,showUploader:!1}},computed:{_attachments:function(){return this.attachments.map((function(t){return Object(r["resolveImagePath"])(t)}))}},methods:{deleteComment:function(){this.$emit("deteleComment")},dataFormat:function(t){var e=new Date(t);return e.getFullYear()+"-"+O(e.getMonth()+1)+"-"+O(e.getDate())+" "+O(e.getHours())+":"+O(e.getMinutes())+":"+O(e.getSeconds())},attachmentUploadFinish:function(t){this.disableSubmitBtn=!1,this.$emit("addNewReply",{content:this.newComment.content,attachmentList:t}),this.showUploader=!1,this.newComment={}},attachmentUplodError:function(){this.disableSubmitBtn=!1},submit:function(){this.disableSubmitBtn=!0,this.$refs.uploader?this.$refs.uploader.upload():this.attachmentUploadFinish([])},hideForm:function(){}},filters:{showAttachment:function(t){return Object(r["resolveImagePath"])(t)+"?x-oss-process=style/comment_thumb"}}},P=T,$=(n("e314"),Object(d["a"])(P,N,I,!1,null,null,null)),F=$.exports,U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.data.length?n("div",{staticClass:"c-comment-replylist"},[t._l(t.data,(function(e){return n("reply-item",{key:e.id,staticClass:"c-comment-reply",attrs:{reply:e,power:t.power},on:{deleteReply:t.deleteReply,addReply:t.addReply}})})),n("el-row",[t.data.length>=3||t.showPager?n("el-col",{attrs:{span:1}},[n("el-button",{directives:[{name:"show",rawName:"v-show",value:t.showPager,expression:"showPager"}],attrs:{type:"text"},on:{click:function(e){return t.showLess()}}},[t._v("收起")]),n("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.showPager,expression:"!showPager"}],attrs:{type:"text"},on:{click:function(e){return t.showMore()}}},[t._v("查看更多")])],1):t._e(),n("el-col",{staticClass:"c-comment-reply-pages",attrs:{span:23}},[n("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.showPager,expression:"showPager"}],attrs:{small:"","current-page":t.pager.index,"page-size":t.pager.pageSize,layout:"total, prev, pager, next",total:t.pager.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){return t.$set(t.pager,"index",e)},"update:current-page":function(e){return t.$set(t.pager,"index",e)}}})],1)],1)],2):t._e()},j=[],z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-row",[n("Avatar",{attrs:{"user-avatar":t.showAvatar(t.reply.avatar),"user-href":t._f("profileLink")(t.reply.userId),username:t.reply.displayName}}),n("CommentContentSimple",{attrs:{"comment-id":t.reply.id,date:t.reply.commentDate,content:t.reply.content,attachments:t._f("stringToArray")(t.reply.attachments),"can-delete":t.power.allow||t.power.uid==t.reply.userId,"can-reply":t.power.uid!=t.reply.userId,"user-href":t._f("profileLink")(t.reply.replyForUID),"reply-for-username":t.reply.replyForUsername,"reply-for-user-id":t.reply.replyForUID},on:{delete:t.deleteReply,showReplyInput:function(e){t.showReplyForReplyFrom=!t.showReplyForReplyFrom}}}),t.showReplyForReplyFrom?n("ReplyForReply",{attrs:{username:t.reply.displayName,"user-href":t._f("profileLink")(t.reply.userId)},on:{hideForm:function(e){t.showReplyForReplyFrom=!1},doReply:t.doReply}}):t._e()],1)},B=[],G=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"u-reply"},[n("div",{staticClass:"u-reply-content"},[0!=t.replyForUserId?n("span",{staticClass:"u-reply-label"},[t._v(" 回复 "),n("el-link",{attrs:{type:"primary",target:"_blank",href:t.userHref}},[t._v("@"+t._s(t.replyForUsername))]),t._v(" : ")],1):t._e(),t._l(t.getPList(t.content),(function(e,a){return n("p",{key:a},[t._v(t._s(e))])}))],2),t.attachments.length?n("div",{staticClass:"u-attachements"},t._l(t.attachments,(function(e){return n("el-image",{key:e,attrs:{src:t._f("showAttachment")(e),"preview-src-list":t._attachments,lazy:""}})})),1):t._e(),n("div",{staticClass:"u-toolbar"},[t.canDelete?n("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-delete",size:"mini"},on:{click:function(e){return t.deleteComment()}}},[t._v("删除")]):t._e(),t.canReply?n("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-chat-line-round",size:"mini"},on:{click:function(e){return t.showReplyForReplyInput()}}},[t._v("回复")]):t._e(),n("time",{staticClass:"u-date"},[n("i",{staticClass:"el-icon-time"}),t._v(" "+t._s(t.dataFormat(t.date))+" ")])],1)])},M=[];n("1276"),n("ac1f");function D(t){return t>9?t:"0".concat(t)}var H={props:["commentId","content","attachments","date","hasReply","canDelete","canReply","userHref","replyForUsername","replyForUserId"],data:function(){return{showInput:!1}},computed:{_attachments:function(){return this.attachments.map((function(t){return Object(r["resolveImagePath"])(t)}))}},filters:{profileLink:function(t){return Object(r["authorLink"])(t)},showAttachment:function(t){return Object(r["resolveImagePath"])(t)+"?x-oss-process=style/comment_thumb"}},methods:{getPList:function(t){return t.split("\n")},deleteComment:function(){this.$emit("delete",this.commentId)},dataFormat:function(t){var e=new Date(t);return e.getFullYear()+"-"+D(e.getMonth()+1)+"-"+D(e.getDate())+" "+D(e.getHours())+":"+D(e.getMinutes())+":"+D(e.getSeconds())},showReplyForReplyInput:function(){this.$emit("showReplyInput")}}},W=H,q=(n("0b4e"),Object(d["a"])(W,G,M,!1,null,null,null)),J=q.exports,X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-form",{ref:"form",staticClass:"c-comment-subbox"},[n("div",{staticClass:"u-subbox-label"},[t._v(" 回复 "),n("el-link",{attrs:{type:"primary",target:"_blank",href:t.userHref}},[t._v("＠"+t._s(t.username))]),t._v(" ： ")],1),n("el-form-item",[n("el-input",{attrs:{type:"textarea"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),n("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-picture",size:"mini"},on:{click:function(e){t.showUploader=!t.showUploader}}},[t._v("图片")])],1),n("el-form-item",[t.showUploader?n("Uploader",{ref:"uploader",on:{onFinish:t.attachmentUploadFinish,onError:t.attachmentUplodError}}):t._e()],1),n("el-form-item",[n("el-button",{attrs:{size:"mini",type:"primary",disabled:t.disableSubmitBtn},on:{click:function(e){return t.submintReply()}}},[t._v("提交")]),n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.hideForm()}}},[t._v("收起")])],1)],1)},Q=[],V={props:["username","userHref"],data:function(){return{content:"",showUploader:!1,disableSubmitBtn:!1}},components:{Uploader:E},methods:{submintReply:function(){this.disableSubmitBtn=!0,this.$refs.uploader?this.$refs.uploader.upload():this.attachmentUploadFinish([])},hideForm:function(){this.$emit("hideForm")},attachmentUploadFinish:function(t){this.disableSubmitBtn=!1,this.$emit("doReply",{content:this.content,attachmentList:t}),this.content="",this.showUploader=!1},attachmentUplodError:function(){this.disableSubmitBtn=!1}}},Y=V,K=(n("0837"),Object(d["a"])(Y,X,Q,!1,null,null,null)),Z=K.exports,tt={props:["reply","power"],components:{Avatar:f,CommentContentSimple:J,ReplyForReply:Z},backReplyList:[],data:function(){return{showReplyForReplyFrom:!1}},filters:{profileLink:function(t){return Object(r["authorLink"])(t)},stringToArray:function(t){return t?JSON.parse(t):[]}},methods:{showAvatar:function(t){return t?Object(r["getThumbnail"])(t,28,!0):Object(r["getThumbnail"])(l["default_avatar"],28)},deleteReply:function(t){this.$emit("deleteReply",t)},doReply:function(t){t.replyForUID=this.reply.userId,t.replyForCommentId=this.reply.id,this.$emit("addReply",t),this.showReplyForReplyFrom=!1}}},et=tt,nt=Object(d["a"])(et,z,B,!1,null,null,null),at=nt.exports,it={props:["data","power","pager"],components:{ReplyItem:at},data:function(){return{showPager:!1}},filters:{profileLink:function(t){return Object(r["authorLink"])(t)}},methods:{showAvatar:r["showAvatar"],showMore:function(){this.showPager=!0,this.$emit("goto",1)},showLess:function(){this.showPager=!1,this.$emit("resetReply")},handleCurrentChange:function(t){this.$emit("goto",t)},deleteReply:function(t){this.$emit("deleteReply",t)},addReply:function(t){this.$emit("addNewReply",t)}}},st=it,ot=(n("8366"),Object(d["a"])(st,U,j,!1,null,null,null)),rt=ot.exports,lt=n("ee8f"),ct=n("5c96");const ut=function(t,e){let n={method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}};return ht(t,e,n)};var pt={};const mt=function(t,e,n){if(pt[t])if(Date.now()-pt[t].lastest<6e4){if(pt[t].count>=6)return ct["Notification"].warning({title:"系统",message:"你单身多久了? 动作这么快, 系统处理不过来 ( T_T )",duration:3e3,position:"bottom-right"}),new Promise((t,e)=>{e()});pt[t].count=pt[t].count+1}else Date.now()-pt[t].lastest>6e4&&(pt[t]={lastest:Date.now(),count:0});else pt[t]={lastest:Date.now(),count:0};let a={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)};return ht(t,e,a)},dt=function(t,e){let n={method:"DELETE"};return ht(t,e,n)};function ht(t,e,n){let a=lt["JX3BOX"].__next;if("/"==a[a.length-1]&&(a=a.substring(0,a.length-1)),t=a+t,n.credentials="include",e){let n=[];Object.keys(e).forEach(t=>{n.push(t+"="+e[t])});let a=lt["JX3BOX"].__next;"/"==a[a.length-1]&&(a=a.substring(0,a.length-1)),t=t+"?"+n.join("&")}return fetch(t,n).then(t=>{switch(t.status){case 200:break;case 401:throw window.location.href=lt["JX3BOX"].__Links.account.login+"?redirect="+encodeURIComponent(window.location.href),new Error("错误:"+t.statusText);case 403:throw window.location.href=lt["JX3BOX"].__Links.account.login+"?redirect="+encodeURIComponent(window.location.href),new Error("错误:"+t.statusText);case 423:throw window.location.href=lt["JX3BOX"].__Links.account.email_verify+"?redirect="+encodeURIComponent(window.location.href),new Error("错误:"+t.statusText);case 406:throw t.text().then(t=>{ct["Notification"].warning({title:"系统",message:t||"提交内容不合法,请重新提交",duration:3e3,position:"bottom-right"})}),new Error("错误:"+t.statusText);default:throw t.text().then(e=>{ct["Notification"].error({title:"系统:"+t.statusText,message:e||"系统错误,请稍后重试!",duration:3e3,position:"bottom-right"})}),new Error("错误:"+t.statusText)}let e=t.headers.get("Content-Type");switch(e=e&&e.split(";").shift(),e){case"application/json":return t.json();default:return t.text()}})}var ft={props:["item","baseApi","power","user-href","username"],components:{CommentContent:F,ReplyList:rt},data:function(){return{replyList:[],pager:{index:1,pageSize:10,pageTotal:1,total:0}}},filters:{stringToArray:function(t){return t?JSON.parse(t):[]}},created:function(){this.replyList=this.item.reply||[]},methods:{deteleComment:function(){this.$emit("deteleComment",this.item.id)},addNewReply:function(t){var e=this;mt("".concat(this.baseApi,"/comment/").concat(this.item.id,"/reply"),null,t).then((function(){e.$notify({title:"",message:"评论成功!",type:"success",duration:3e3,position:"bottom-right"}),e.loadReplyList(e.pager.index)})).catch((function(){}))},deleteReply:function(t){var e=this;dt("".concat(this.baseApi,"/comment/").concat(t)).then((function(){e.$notify({title:"",message:"删除成功!",type:"success",duration:3e3,position:"bottom-right"}),e.loadReplyList(e.pager.index)})).catch((function(){}))},gotoReplyListIndex:function(t){this.loadReplyList(t,6)},loadReplyList:function(t,e){var n=this;ut("".concat(this.baseApi,"/comment/").concat(this.item.id,"/reply/page/").concat(t,"?pageSize=").concat(e)).then((function(a){1==t&&3==e&&(n.item.reply=a.data||[]),n.replyList=a.data||[],n.pager=a.page})).catch((function(){}))},resetReply:function(){this.loadReplyList(1,3)}}},_t=ft,yt=Object(d["a"])(_t,L,S,!1,null,null,null),bt=yt.exports,gt={name:"Comment",props:["id","category"],components:{Avatar:f,CommmentWithReply:bt,CommentInputForm:R},data:function(){return{baseAPI:"",commentPower:{allow:!1,uid:-1},commentList:[],pager:{index:1,pageSize:10,pageTotal:1,total:0}}},methods:{deteleComment:function(t){var e=this;dt("".concat(this.baseAPI,"/comment/").concat(t)).then((function(){e.$notify({title:"",message:"删除成功!",type:"success",duration:3e3,position:"bottom-right"}),e.reloadCommentList(e.pager.index)})).catch((function(){}))},reloadCommentList:function(t){var e=this;ut("".concat(this.baseAPI,"/comment/page/").concat(t)).then((function(t){e.commentList=t.data||[],e.pager=t.page})).catch((function(){}))},handleCurrentChange:function(t){this.reloadCommentList(t)},userSubmitInputForm:function(t){var e=this;mt("".concat(this.baseAPI,"/comment"),null,t).then((function(){e.$notify({title:"",message:"评论成功!",type:"success",duration:3e3,position:"bottom-right"}),1==e.pager.index&&e.reloadCommentList(e.pager.index)})).catch((function(){}))}},filters:{profileLink:function(t){return Object(r["authorLink"])(t)},showAvatar:function(t){return t?Object(r["getThumbnail"])(t,48,!0):Object(r["getThumbnail"])(l["default_avatar"],48)}},created:function(){this.baseAPI="/api/comment/".concat(this.category,"/article/").concat(this.id)},mounted:function(){var t=this;this.reloadCommentList(1),ut("".concat(this.baseAPI,"/i-am-author")).then((function(e){t.commentPower=e})).catch((function(){}))}},vt=gt,wt=(n("ae14"),Object(d["a"])(vt,s,o,!1,null,null,null)),Ct=wt.exports,Et=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.item?n("el-popover",{attrs:{placement:"right-end","popper-class":"m-simple-item-popup",width:"auto","visible-arrow":!1,trigger:"hover",transition:"none","close-delay":0},on:{show:function(e){t.item_id=t.item.id}},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[n("div",{staticClass:"m-simple-item",class:{onlyIcon:t.onlyIcon,withName:t.withName},attrs:{slot:"reference"},on:{mousedown:function(e){t.visible=!1}},slot:"reference"},[n("div",{staticClass:"m-icon"},[n("div",{staticClass:"u-border",style:{backgroundImage:t.item_border(t.item),opacity:5==t.item.Quality?.9:1}}),n("div",{staticClass:"u-border-quest",style:{backgroundImage:t.item_border_quest(t.item)}}),n("img",{staticClass:"u-icon",style:{width:t.iconSize,height:t.iconSize},attrs:{src:t.icon_url(t.item.IconID),alt:"IconID:"+t.item.IconID}})]),n("span",{staticClass:"u-name",style:{color:t.item_color(t.item.Quality)},domProps:{textContent:t._s(t.item.Name)}}),n("span",{staticClass:"u-uiid fr",domProps:{textContent:t._s("ID: "+t.item.id)}})]),n("jx3-item",{attrs:{item_id:t.item_id}})],1):t._e()},At=[],xt=n("c7fa"),kt=n("4b8c"),Rt=n("1d18");const{__imgPath:Lt}=n("64c7");var St=t=>{switch(t.Quality){case 3:return`url(${Lt}image/item/blue.png)`;case 4:return`url(${Lt}image/item/purple.png)`;case 5:return`url(${Lt}image/item/orange.gif)`;default:return""}};const{__imgPath:Nt}=n("64c7");var It=t=>t.IsQuest>0?`url(${Nt}image/item/renwu.png)`:"",Ot={name:"ItemSimple",props:["item","onlyIcon","iconSize","withName"],data:function(){return{visible:!1,item_id:null}},methods:{icon_url:kt["a"],item_color:Rt["a"],item_border:St,item_border_quest:It},components:{"jx3-item":xt["a"]}},Tt=Ot,Pt=(n("ecd9"),n("85ca"),Object(d["a"])(Tt,Et,At,!1,null,null,null)),$t=Pt.exports,Ft=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.plan?n("div",{staticClass:"c-equip"},[t._l(t.equip,(function(t,e){return n("div",{key:e,staticClass:"u-equip",class:"u-equip-"+e},[n("jx3-item-simple",{attrs:{item:t,onlyIcon:!0,iconSize:"56px",withName:!0}})],1)})),n("div",{staticClass:"u-info"},[n("div",{staticClass:"u-title"},[t._v(t._s(t.plan.title))]),n("a",{staticClass:"u-author",attrs:{href:t.userpage,target:"_blank"}},[n("img",{staticClass:"u-author-avatar",attrs:{src:t.avatar}}),n("span",{staticClass:"u-author-name"},[t._v(t._s(t.plan.user_nickname))])]),n("div",{staticClass:"u-time"},[n("i",{staticClass:"el-icon-date"}),t._v(" "+t._s(t._f("showTime")(1e3*t.plan.updated)))]),n("div",{staticClass:"u-desc"},[t._v(t._s(t.plan.description))]),n("div",{staticClass:"u-qrcodebox"},[n("QRcode",{attrs:{href:t.link,s:120,v:"static"}})],1)]),n("div",{staticClass:"u-misc"},[n("a",{staticClass:"u-logo",attrs:{href:t.link,target:"_blank"}},[n("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"256",height:"256",viewBox:"0 0 256 256","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[n("path",{staticClass:"fil0",attrs:{d:"M129.254 5.842l102.93 59.427-31.87 18.4-.982-.566c.994-2.975-.028-5.876-2.019-8.167l-4.238-4.874-4.875-4.238c-4.609-4.007-11.22-2.951-13.087 3.295l-45.859-26.476-48.092 27.766c-3.008-2.576-6.243-4.596-7.711-5.336.556 3.007 1.122 5.906 1.436 8.959l-16.692 9.637-31.87-18.4L129.254 5.842zM236 71.878v118.854l-102.929 59.426v-36.801l71.059-41.026V90.279L236 71.878zm-110.561 178.28l-102.93-59.426V71.878l31.87 18.401v38.385a71.299 71.299 0 00-9.941 3.888c3.476 1.394 6.816 2.952 9.941 4.768v35.011l13.63 7.87c-.448 5.196-.681 10.447-.884 15.81 7.698-.047 17.263-.298 24.365-2.254l33.949 19.6v36.801zM73.64 189.497c.616-12.288.824-17.667 6.46-25.262 5.453 5.878 11.556 10.552 18.453 13.546a44.686 44.686 0 004.644 1.718c-10.202 9.114-15.093 9.273-29.557 9.998zm55.206-82.269a30.61 30.61 0 00-4.996 4.101c-2.432 2.476-4.35 5.302-5.436 8.228l6.691-6.474c1.381-1.335 2.902-4.048 3.741-5.855zm15.54-14.454c-2.664.429-4.875 1.064-6.833 1.861 2.112.623 4.007 1.195 6.817 2.037l.016-3.898zm15.213-7.165l1.942.821 1.516-1.49a56.852 56.852 0 00-6.694-2.647l3.236 3.316zm-7.44-4.519c-3.687-.918-7.615-1.549-11.775-1.863 2.509-1.954 8.004-2.992 11.839-3.871-6.24-2.525-17.137-2.863-26.058-.017-.495 1.506-1.483 3.868-2.685 4.952-1.586 1.43-3.063 2.694-4.373 3.915 10.1-4.479 20.923-4.799 31.527-1.855l1.525-1.261zM82.1 80.589c1.213 7.898-1.998 20.612-2.61 22.231-.613 1.618-1.421 3.479-4.084 10.137-2.664 6.658-2.451 19.463-.66 23.5-4.342-3.055-9.693-4.784-14.795-2.94 8.582 4.379 13.448 14.094 19.147 21.551 13.089 17.129 29.219 25.133 49.926 19.37 10.231-2.847 25.104-22.701 16.335-30.342-15.181 8.569-31.513-2.404-32.155-19.114-.467-12.171 12.786-24.526 25.65-26.107-5.249-1.572-7.043-2.387-13.788-1.313 6.068-4.449 10.642-7.967 21.017-8.998.637-1.192 1.667-2.01 2.687-2.853-12.985-3.363-31.961-2.924-48.429 18.886 4.904-10.82 8.443-15.182 20.698-27.127 3.233-3.151 2.587-7.771 2.183-10.966-3.448 5.663-9.754 8.745-18.349 12.542-6.518 2.879-12.428 7.647-16.78 13.669-1.091-4.665-2.175-8.865-5.993-12.126zm62.075 89.198a95.605 95.605 0 004.608-2.046c-4.35 7.066-14.86 14.943-33.852 17.435 20.304 5.345 39.698 2.31 51.914-10.359-.979 1.719-1.998 3.546-3.118 5.174 14.984-8.658 34.487-34.111 20.514-58.638 2.36 1.92 4.335 4.253 6.008 7.432.11-11.661-3.429-22.244-10.167-30.625l-3.947 4.018 7.299 7.124-5.446 6.584c-2.667 3.225-4.416 3.231-7.72 3.242l-4.616.018c-.087 1.544-.742 2.979-1.882 4.027l-.072 3.376c-.069 3.225-1.915 6.394-5.122 7.359l.001.005c-3.864 1.15-7.022 3.497-9.786 6.353 1.943 1.713 3.186 3.805 3.841 6.157 1.06 3.809.418 8.087-1.322 12.281-1.663 4.008-4.251 7.851-7.135 11.083zm-25.774-43.979l9.782-9.463c1.993-1.929 4.901-6.745 5.964-10.318.226-.761 1.197-1.434 2.541-1.463l6.485-.139.357-1.122c.196-.616.459-.706 1.011-.709l4.176-.02a.392.392 0 00.379-.39l.037-9.184c.007-1.797-.026-2.719 1.393-3.893l2.944-2.433 7.412 7.594 18.945-18.61 1.185-4.634c.463-1.81 1.741-1.749 3.146-.528l4.538 3.945 3.945 4.538c1.22 1.405 1.282 2.683-.528 3.146l-4.634 1.185-18.611 18.945 7.595 7.412-2.434 2.943c-1.173 1.42-2.096 1.387-3.892 1.394l-9.184.037a.39.39 0 00-.39.379l-.02 4.176c-.003.552-.093.815-.709 1.011l-1.122.358-.139 6.484c-.029 1.344-.703 2.315-1.463 2.541-3.573 1.063-8.389 3.971-10.318 5.964l-5.142 5.316c-5.88 2.918-11.824 2.547-17.096-2.205-3.029-2.731-5.197-6.561-5.943-10.779a20.577 20.577 0 01-.21-1.478z"}})]),n("span",[t._v("配装ID:"+t._s(t.plan.id))])])])],2):t._e()},Ut=[];const jt=Object.freeze({HELM:"helm",CHEST:"chest",WAIST:"waist",BANGLE:"bangle",PANTS:"pants",BOOTS:"boots",AMULET:"amulet",PENDANT:"pendant",RING:"ring",MELEE_WEAPON:"melee_weapon",RANGE_WEAPON:"range_weapon",AMMO_POUCH:"ammo_pouch",all(){return[this.HELM,this.CHEST,this.WAIST,this.BANGLE,this.PANTS,this.BOOTS,this.AMULET,this.PENDANT,this.RING,this.MELEE_WEAPON,this.RANGE_WEAPON,this.AMMO_POUCH]}});var zt=jt;const Bt=Object.freeze({HELM:zt.HELM,CHEST:zt.CHEST,WAIST:zt.WAIST,BANGLE:zt.BANGLE,PANTS:zt.PANTS,BOOTS:zt.BOOTS,AMULET:zt.AMULET,PENDANT:zt.PENDANT,RING_1:zt.RING+"_1",RING_2:zt.RING+"_2",MELEE_WEAPON:zt.MELEE_WEAPON,RANGE_WEAPON:zt.RANGE_WEAPON,all(){let t=[{type:this.MELEE_WEAPON,label:"武器",AucGenre:1},{type:this.RANGE_WEAPON,label:"暗器",AucGenre:2},{type:this.HELM,label:"帽子",AucGenre:3,AucSubType:2},{type:this.CHEST,label:"上衣",AucGenre:3,AucSubType:1},{type:this.WAIST,label:"腰带",AucGenre:3,AucSubType:3},{type:this.BANGLE,label:"护腕",AucGenre:3,AucSubType:6},{type:this.PANTS,label:"下装",AucGenre:3,AucSubType:4},{type:this.BOOTS,label:"鞋子",AucGenre:3,AucSubType:5},{type:this.AMULET,label:"项链",AucGenre:4,AucSubType:1},{type:this.PENDANT,label:"腰坠",AucGenre:4,AucSubType:3},{type:this.RING_1,label:"戒指",AucGenre:4,AucSubType:2},{type:this.RING_2,label:"戒指",AucGenre:4,AucSubType:2}],e={};for(let n in t){let a=t[n];e[a.type]=a}return e}});var Gt=Bt,Mt=n("48d2"),Dt=n("e4f1"),Ht=n("4ae4"),Wt={props:["data","id"],data:function(){return{plan_data:""}},computed:{plan:function(){return this.id?this.plan_data:this.data},equip:function(){return{weapon_1:this.plan.relation_items[Gt.MELEE_WEAPON][0],weapon_2:this.plan.relation_items[Gt.RANGE_WEAPON][0],cap:this.plan.relation_items[Gt.HELM][0],cloth:this.plan.relation_items[Gt.CHEST][0],belt:this.plan.relation_items[Gt.WAIST][0],wrist:this.plan.relation_items[Gt.BANGLE][0],trousers:this.plan.relation_items[Gt.PANTS][0],shoes:this.plan.relation_items[Gt.BOOTS][0],necklace:this.plan.relation_items[Gt.AMULET][0],pendant:this.plan.relation_items[Gt.PENDANT][0],ring_1:this.plan.relation_items[Gt.RING_1][0],ring_2:this.plan.relation_items[Gt.RING_2][0]}},avatar:function(){return this.plan?this.plan.user_avatar:""},username:function(){return this.plan?this.plan.user_nickname:""},uid:function(){return this.plan?this.plan.user_id:""},userpage:function(){return this.uid?Object(r["authorLink"])(this.uid):""},link:function(){return this.plan?"https://www.jx3box.com/item/#/plan_view/".concat(this.plan.id):""}},methods:{},filters:{showTime:Dt["b"]},mounted:function(){var t=this;this.id&&Object(Ht["b"])(this.id).then((function(e){t.plan_data=e.data.data.plan}))},components:{"jx3-item-simple":$t,QRcode:Mt["a"]}},qt=Wt,Jt=(n("bc2e"),Object(d["a"])(qt,Ft,Ut,!1,null,null,null)),Xt=Jt.exports,Qt=n("5bb7"),Vt=n("c9d2"),Yt=n("1d10"),Kt=n("e494"),Zt=n("208a"),te=n("2ef0"),ee=n("ee8f"),ne=ee.JX3BOX,ae={name:"PlanDetail",components:{"jx3-item-simple":$t,"jx3-comment":Ct,Equip:Xt,PlanSearch:Yt["a"],Fav:Qt["a"]},data:function(){var t=[[Gt.MELEE_WEAPON,Gt.RANGE_WEAPON],[Gt.HELM,Gt.CHEST,Gt.WAIST],[Gt.BANGLE,Gt.PANTS,Gt.BOOTS],[Gt.AMULET,Gt.PENDANT,Gt.RING_1,Gt.RING_2]],e=Gt.all();for(var n in t){var a={};for(var i in t[n]){var s=te.get(t,"".concat(n,".").concat(i));a[s]=e[s]}te.set(t,n,a)}return{user:Vt["a"].getInfo(),plan:null,positions:t}},mounted:function(){Object(Kt["b"])(this.$route.params.plan_id)},watch:{"$route.params.plan_id":{immediate:!0,handler:function(){var t=this;this.$route.params.plan_id&&Object(Zt["b"])(this.$route.params.plan_id).then((function(e){e=e.data,200===e.code?t.plan=e.data.plan:t.$message.error("获取物品清单异常，请联系管理员")}))}}},methods:{publish_url:function(t){return"".concat(ne.__Links.dashboard.publish,"#/").concat(t)},edit_plan:function(t){location.href=this.publish_url("item/plan/".concat(t))},delete_plan:function(t){var e=this;this.$confirm("确认是否删除该物品清单？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(Zt["a"])(t).then((function(t){t=t.data,200===t.code?(e.$message.success(t.message),Object(Zt["d"])(),e.$router.push({name:"home"})):e.$message.error(t.message)}))}))}},filters:{showAvatar:function(t){return Object(r["getThumbnail"])(t,24,!0)}}},ie=ae,se=(n("f0a4"),Object(d["a"])(ie,a,i,!1,null,"0f4c238e",null));e["default"]=se.exports},8366:function(t,e,n){"use strict";n("b07e")},8386:function(t,e,n){},"85ca":function(t,e,n){"use strict";n("1229")},"9a16":function(t,e,n){},ae14:function(t,e,n){"use strict";n("c2ee")},b07e:function(t,e,n){},b9c79:function(t,e,n){},bc2e:function(t,e,n){"use strict";n("9a16")},c0ba:function(t,e,n){"use strict";n("084d")},c2ee:function(t,e,n){},d81d:function(t,e,n){"use strict";var a=n("23e7"),i=n("b727").map,s=n("1dde"),o=s("map");a({target:"Array",proto:!0,forced:!o},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},dcac:function(t,e,n){"use strict";n("624c")},e314:function(t,e,n){"use strict";n("f263")},e7d2:function(t,e,n){},ecd9:function(t,e,n){"use strict";n("2d41")},f0a4:function(t,e,n){"use strict";n("8386")},f263:function(t,e,n){}}]);
//# sourceMappingURL=chunk-88441a64.0e0c96b6.js.map