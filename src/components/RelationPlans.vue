<template>
    <div class="m-relation-plans">
        <el-row :gutter="20" v-if="relation_plans.length">
            <el-col :span="12" v-for="(plan, key) in relation_plans" :key="key">
                <div class="u-plan">
                    <span
                        v-if="plan.type == 1"
                        class="u-type"
                        :class="'u-type-' + plan.type"
                    >
                        <img :src="plan_1_icon" />
                    </span>
                    <span
                        v-if="plan.type == 2"
                        class="u-type"
                        :class="'u-type-' + plan.type"
                    >
                        <img :src="plan_2_icon" />
                    </span>
                    <router-link
                        class="u-name"
                        v-text="plan.title"
                        :to="{
                            name: 'plan_view',
                            params: { plan_id: plan.id },
                        }"
                    ></router-link>
                    <span class="u-desc" v-text="plan.description"></span>
                </div>
            </el-col>
        </el-row>
        <div v-else style="text-align: center">üêñ ÊöÇÊó†ËÆ∞ÂΩï</div>
    </div>
</template>

<script>
import { get_item_relation_plans } from "../service/item";
import { __iconPath } from "@jx3box/jx3box-common/data/jx3box.json";

export default {
    name: "RelationPlans",
    props: ["item_id"],
    data() {
        return {
            relation_plans: [],
            plan_2_icon: __iconPath + "icon/2410.png",
            plan_1_icon: __iconPath + "icon/3089.png",
        };
    },
    watch: {
        item_id: {
            immediate: true,
            handler() {
                if (this.item_id) {
                    get_item_relation_plans(this.item_id, { limit: 6 }).then(
                        (data) => {
                            data = data.data
                            this.relation_plans = data.data.data;
                        },
                        (err) => {
                            this.relation_plans = [];
                        }
                    );
                }
            },
        },
    },
};
</script>

<style lang="less">
@import "../assets/css/components/relation_plans.less";
</style>
